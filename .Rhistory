serie<-ts(read.table("./data/entradTur.dat")/1000000,start=2000,freq=12)
plot(serie,main="Entrada Turística a Espanya",ylab="Milions")
abline(v=1999:2019,col=4,lty=3)
plot(decompose(serie))
par(mfrow=c(1,2))
m=apply(matrix(serie,nr=12),2,mean)
v=apply(matrix(serie,nr=12),2,var)
plot(m,v,xlab="Mitjanes anuals",ylab="Variàncies anuals",main="Mean-Variance Plot")
abline(lm(v~m),col=2,lty=3,lwd=2)
boxplot(serie~floor(time(serie)))
logserie <- log(serie)
par(mfrow=c(1,2))
logm=apply(matrix(logserie,nr=12),2,mean)
logv=apply(matrix(logserie,nr=12),2,var)
plot(logm,logv,xlab="Mitjanes anuals",ylab="Variàncies anuals",main="Mean-Variance Plot")
abline(lm(logv~logm),col=2,lty=3,lwd=2)
boxplot(logserie~floor(time(logserie)))
monthplot(logserie)
d12logserie <- diff(logserie,12)
monthplot(d12logserie)
d1d12logserie <- diff(d12logserie)
plot(d1d12logserie)
mean(d1d12logserie)
var(d1d12logserie)
d1d1d12logserie <- diff(d1d12logserie)
plot(d1d1d12logserie)
mean(d1d1d12logserie)
var(d1d1d12logserie)
par(mfrow=c(1,2))
acf(d1d12logserie,ylim=c(-1,1),col=c(2,rep(1,11)),lwd=2,lag.max=72)
pacf(d1d12logserie,ylim=c(-1,1),col=c(rep(1,11),2),lwd=2,lag.max=72)
par(mfrow=c(1,1))
serie<-ts(read.table("./data/EntradTur.dat")/1000000,start=2000,freq=12)
plot(serie,main="Entrada Turística a Espanya",ylab="Milions")
abline(v=1999:2019,col=4,lty=3)
plot(decompose(serie))
par(mfrow=c(1,2))
m=apply(matrix(serie,nr=12),2,mean)
v=apply(matrix(serie,nr=12),2,var)
plot(m,v,xlab="Mitjanes anuals",ylab="Variàncies anuals",main="Mean-Variance Plot")
abline(lm(v~m),col=2,lty=3,lwd=2)
boxplot(serie~floor(time(serie)))
logserie <- log(serie)
par(mfrow=c(1,2))
logm=apply(matrix(logserie,nr=12),2,mean)
logv=apply(matrix(logserie,nr=12),2,var)
plot(logm,logv,xlab="Mitjanes anuals",ylab="Variàncies anuals",main="Mean-Variance Plot")
abline(lm(logv~logm),col=2,lty=3,lwd=2)
boxplot(logserie~floor(time(logserie)))
monthplot(logserie)
d12logserie <- diff(logserie,12)
monthplot(d12logserie)
d1d12logserie <- diff(d12logserie)
plot(d1d12logserie)
mean(d1d12logserie)
var(d1d12logserie)
d1d1d12logserie <- diff(d1d12logserie)
plot(d1d1d12logserie)
mean(d1d1d12logserie)
var(d1d1d12logserie)
par(mfrow=c(1,2))
acf(d1d12logserie,ylim=c(-1,1),col=c(2,rep(1,11)),lwd=2,lag.max=72)
pacf(d1d12logserie,ylim=c(-1,1),col=c(rep(1,11),2),lwd=2,lag.max=72)
par(mfrow=c(1,1))
pdq.1 <- c(0, 1, 1)
PDQ.1 <- c(1, 1, 0)
(mod.1 <- arima(logserie, order=pdq.1, seasonal = list(order = PDQ.1, period=12)))
pdq.2 <- c(1, 1, 1)
PDQ.2 <- c(1, 1, 0)
(mod.2 <- arima(logserie, order = pdq.2, seasonal = list(order = PDQ.2, period=12)))
mod.1$coef
mod.1$var.coef
abs(model$coef/sqrt(diag(model$var.coef))>2
print(abs(model$coef/sqrt(diag(model$var.coef))>2)
print(abs(model$coef/sqrt(diag(model$var.coef))>2))
print(abs(mod.1$coef/sqrt(diag(mod.1$var.coef))>2))
mod.1$coef/sqrt(diag(mod.1$var.coef)
mod.1$coef/sqrt(diag(mod.1$var.coef))
abs(mod.1$coef/sqrt(diag(mod.1$var.coef)))
abs(mod.1$coef/sqrt(diag(mod.1$var.coef)))>2
pdq.1 <- c(0, 1, 1)
PDQ.1 <- c(1, 1, 0)
(mod.1 <- arima(logserie, order=pdq.1, seasonal = list(order = PDQ.1, period=12)))
pdq.2 <- c(1, 1, 1)
PDQ.2 <- c(1, 1, 0)
(mod.2 <- arima(logserie, order = pdq.2, seasonal = list(order = PDQ.2, period=12)))
abs(mod$coef/sqrt(diag(mod$var.coef)))>2
abs(mod.1$coef/sqrt(diag(mod.1$var.coef)))>2
abs(mod2$coef/sqrt(diag(mod2$var.coef)))>2
abs(mod.2$coef/sqrt(diag(mod.2$var.coef)))>2
pdq.1 <- c(0, 1, 1)
PDQ.1 <- c(1, 1, 0)
(mod <- arima(d1d12logserie, order=c(0,0,1), seasonal = list(order = c(1,0,1), period=12)))
(mod.1 <- arima(logserie, order=pdq.1, seasonal = list(order = PDQ.1, period=12)))
pdq.2 <- c(1, 1, 1)
PDQ.2 <- c(1, 1, 0)
(mod2 <- arima(d1d12logserie, order=c(1,0,1), seasonal = list(order = c(1,0,1), period=12)))
(mod.2 <- arima(logserie, order=pdq.2, seasonal = list(order = PDQ.2, period=12)))
abs(mod$coef/sqrt(diag(mod$var.coef)))>2
abs(mod.1$coef/sqrt(diag(mod.1$var.coef)))>2
abs(mod2$coef/sqrt(diag(mod2$var.coef)))>2
abs(mod.2$coef/sqrt(diag(mod.2$var.coef)))>2
pdq.1 <- c(0, 1, 1)
PDQ.1 <- c(1, 1, 0)
(mod <- arima(d1d12logserie, order=c(0,0,1), seasonal = list(order = c(1,0,0), period=12)))
(mod.1 <- arima(logserie, order=pdq.1, seasonal = list(order = PDQ.1, period=12)))
pdq.2 <- c(1, 1, 1)
PDQ.2 <- c(1, 1, 0)
(mod2 <- arima(d1d12logserie, order=c(1,0,1), seasonal = list(order = c(1,0,0), period=12)))
(mod.2 <- arima(logserie, order=pdq.2, seasonal = list(order = PDQ.2, period=12)))
abs(mod$coef/sqrt(diag(mod$var.coef)))>2
abs(mod.1$coef/sqrt(diag(mod.1$var.coef)))>2
abs(mod2$coef/sqrt(diag(mod2$var.coef)))>2
abs(mod.2$coef/sqrt(diag(mod.2$var.coef)))>2
pdq.1 <- c(0, 1, 1)
PDQ.1 <- c(1, 1, 0)
(mod.1.int <- arima(d1d12logserie, order=c(0,0,1), seasonal = list(order = c(1,0,0), period=12)))
(mod.1 <- arima(logserie, order=pdq.1, seasonal = list(order = PDQ.1, period=12)))
pdq.2 <- c(1, 1, 1)
PDQ.2 <- c(1, 1, 0)
(mod.2.int <- arima(d1d12logserie, order=c(1,0,1), seasonal = list(order = c(1,0,0), period=12)))
(mod.2 <- arima(logserie, order=pdq.2, seasonal = list(order = PDQ.2, period=12)))
abs(mod.1.int$coef/sqrt(diag(mod.1.int$var.coef)))>2
abs(mod.1$coef/sqrt(diag(mod.1$var.coef)))>2
abs(mod.2.int$coef/sqrt(diag(mod.2.int$var.coef)))>2
abs(mod.2$coef/sqrt(diag(mod.2$var.coef)))>2
source("validation.r")
validation(mod.1, d1d12logserie)
s=frequency(get(model$series))
s=frequency(get(mod.1$series))
resid=model$residuals
model = mod.1
s=frequency(get(model$series))
resid=model$residuals
par(mfrow=c(2,2),mar=c(3,3,3,3))
#Residuals plot
plot(resid,main="Residuals")
abline(h=0)
abline(h=c(-3*sd(resid),3*sd(resid)),lty=3,col=4)
#Square Root of absolute values of residuals (Homocedasticity)
scatter.smooth(sqrt(abs(resid)),main="Square Root of Absolute residuals", lpars=list(col=2))
par(mfrow=c(1,2))
acf(resid^2,ylim=c(-1,1),lag.max=60,col=c(2,rep(1,s-1)),lwd=1)
pacf(resid^2,ylim=c(-1,1),lag.max=60,col=c(rep(1,s-1),2),lwd=1)
par(mfrow=c(1,1))
model = mod.1
s=frequency(get(model$series))
resid=model$residuals
par(mfrow=c(1,2),mar=c(3,3,3,3))
#Residuals plot
plot(resid,main="Residuals")
abline(h=0)
abline(h=c(-3*sd(resid),3*sd(resid)),lty=3,col=4)
#Square Root of absolute values of residuals (Homocedasticity)
scatter.smooth(sqrt(abs(resid)),main="Square Root of Absolute residuals", lpars=list(col=2))
par(mfrow=c(1,2))
acf(resid^2,ylim=c(-1,1),lag.max=60,col=c(2,rep(1,s-1)),lwd=1)
pacf(resid^2,ylim=c(-1,1),lag.max=60,col=c(rep(1,s-1),2),lwd=1)
par(mfrow=c(1,1))
model = mod.1
s=frequency(get(model$series))
resid=model$residuals
par(mfrow=c(1,2),mar=c(3,3,3,3))
#Residuals plot
plot(resid,main="Residuals mod.1")
abline(h=0)
abline(h=c(-3*sd(resid),3*sd(resid)),lty=3,col=4)
#Square Root of absolute values of residuals (Homocedasticity)
scatter.smooth(sqrt(abs(resid)),main="Square Root of Absolute residuals mod.1", lpars=list(col=2))
par(mfrow=c(1,2))
acf(resid^2,ylim=c(-1,1),lag.max=60,col=c(2,rep(1,s-1)),lwd=1, main="mod.1")
pacf(resid^2,ylim=c(-1,1),lag.max=60,col=c(rep(1,s-1),2),lwd=1)
par(mfrow=c(1,1))
model = mod.1
s=frequency(get(model$series))
resid=model$residuals
par(mfrow=c(1,2),mar=c(3,3,3,3))
#Residuals plot
plot(resid,main="Residuals mod.1")
abline(h=0)
abline(h=c(-3*sd(resid),3*sd(resid)),lty=3,col=4)
#Square Root of absolute values of residuals (Homocedasticity)
scatter.smooth(sqrt(abs(resid)),main="Square Root of Absolute residuals mod.1", lpars=list(col=2))
par(mfrow=c(1,2))
acf(resid^2,ylim=c(-1,1),lag.max=60,col=c(2,rep(1,s-1)),lwd=1, main="Series resid^2 mod.1 ACF")
pacf(resid^2,ylim=c(-1,1),lag.max=60,col=c(rep(1,s-1),2),lwd=1, main="Series resid^2 mod.1 PACF")
par(mfrow=c(1,1))
model = mod.2
s=frequency(get(model$series))
resid=model$residuals
par(mfrow=c(1,2),mar=c(3,3,3,3))
#Residuals plot
plot(resid,main="Residuals mod.2")
abline(h=0)
abline(h=c(-3*sd(resid),3*sd(resid)),lty=3,col=4)
#Square Root of absolute values of residuals (Homocedasticity)
scatter.smooth(sqrt(abs(resid)),main="Square Root of Absolute residuals mod.2", lpars=list(col=2))
par(mfrow=c(1,2))
acf(resid^2,ylim=c(-1,1),lag.max=60,col=c(2,rep(1,s-1)),lwd=1, main="Series resid^2 mod.2 ACF")
pacf(resid^2,ylim=c(-1,1),lag.max=60,col=c(rep(1,s-1),2),lwd=1, main="Series resid^2 mod.2 PACF")
par(mfrow=c(1,1))
pdq.1 <- c(0, 1, 1)
PDQ.1 <- c(1, 1, 0)
(mod.1.int <- arima(d1d12logserie, order=c(0,0,1), seasonal = list(order = c(1,0,0), period=12)))
(mod.1 <- arima(logserie, order=pdq.1, seasonal = list(order = PDQ.1, period=12)))
pdq.2 <- c(1, 1, 1)
PDQ.2 <- c(1, 1, 0)
(mod.2.int <- arima(d1d12logserie, order=c(1,0,1), seasonal = list(order = c(1,0,0), period=12)))
(mod.2 <- arima(logserie, order=pdq.2, seasonal = list(order = PDQ.2, period=12)))
abs(mod.1.int$coef/sqrt(diag(mod.1.int$var.coef)))>2
abs(mod.1$coef/sqrt(diag(mod.1$var.coef)))>2
abs(mod.2.int$coef/sqrt(diag(mod.2.int$var.coef)))>2
abs(mod.2$coef/sqrt(diag(mod.2$var.coef)))>2
model = mod.1
s=frequency(get(model$series))
resid=model$residuals
par(mfrow=c(1,2),mar=c(3,3,3,3))
#Residuals plot
plot(resid,main="Residuals mod.1")
abline(h=0)
abline(h=c(-3*sd(resid),3*sd(resid)),lty=3,col=4)
#Square Root of absolute values of residuals (Homocedasticity)
scatter.smooth(sqrt(abs(resid)),main="Square Root of Absolute residuals mod.1", lpars=list(col=2))
par(mfrow=c(1,2))
acf(resid^2,ylim=c(-1,1),lag.max=60,col=c(2,rep(1,s-1)),lwd=1, main="Series resid^2 mod.1 ACF")
pacf(resid^2,ylim=c(-1,1),lag.max=60,col=c(rep(1,s-1),2),lwd=1, main="Series resid^2 mod.1 PACF")
par(mfrow=c(1,1))
model = mod.2
s=frequency(get(model$series))
resid=model$residuals
par(mfrow=c(1,2),mar=c(3,3,3,3))
#Residuals plot
plot(resid,main="Residuals mod.2")
abline(h=0)
abline(h=c(-3*sd(resid),3*sd(resid)),lty=3,col=4)
#Square Root of absolute values of residuals (Homocedasticity)
scatter.smooth(sqrt(abs(resid)),main="Square Root of Absolute residuals mod.2", lpars=list(col=2))
par(mfrow=c(1,2))
acf(resid^2,ylim=c(-1,1),lag.max=60,col=c(2,rep(1,s-1)),lwd=1, main="Series resid^2 mod.2 ACF")
pacf(resid^2,ylim=c(-1,1),lag.max=60,col=c(rep(1,s-1),2),lwd=1, main="Series resid^2 mod.2 PACF")
par(mfrow=c(1,1))
model = mod.1
s=frequency(get(model$series))
resid=model$residuals
par(mfrow=c(1,2),mar=c(3,3,3,3))
#Normal plot of residuals
qqnorm(resid)
qqline(resid,col=2,lwd=2)
##Histogram of residuals with normal curve
hist(resid,breaks=20,freq=FALSE)
curve(dnorm(x,mean=mean(resid),sd=sd(resid)),col=2,add=T)
##Shapiro-Wilks Normality test
print(shapiro.test(resid(model)))
model = mod.2
s=frequency(get(model$series))
resid=model$residuals
par(mfrow=c(1,2),mar=c(3,3,3,3))
#Normal plot of residuals
qqnorm(resid)
qqline(resid,col=2,lwd=2)
##Histogram of residuals with normal curve
hist(resid,breaks=20,freq=FALSE)
curve(dnorm(x,mean=mean(resid),sd=sd(resid)),col=2,add=T)
##Shapiro-Wilks Normality test
print(shapiro.test(resid(model)))
model = mod.1
s=frequency(get(model$series))
resid=model$residuals
#ACF & PACF of residuals
par(mfrow=c(1,2))
acf(resid,ylim=c(-1,1),lag.max=60,col=c(2,rep(1,s-1)),lwd=1)
pacf(resid,ylim=c(-1,1),lag.max=60,col=c(rep(1,s-1),2),lwd=1)
par(mfrow=c(1,1))
#Ljung-Box p-values
par(mar=c(2,2,1,1))
tsdiag(model,gof.lag=7*s)
cat("\n--------------------------------------------------------------------\n")
print(model)
model = mod.1
s=frequency(get(model$series))
resid=model$residuals
#ACF & PACF of residuals
par(mfrow=c(1,2))
acf(resid,ylim=c(-1,1),lag.max=60,col=c(2,rep(1,s-1)),lwd=1)
pacf(resid,ylim=c(-1,1),lag.max=60,col=c(rep(1,s-1),2),lwd=1)
par(mfrow=c(1,1))
#Ljung-Box p-values
par(mar=c(2,2,1,1))
tsdiag(model,gof.lag=7*s)
model = mod.2
s=frequency(get(model$series))
resid=model$residuals
#ACF & PACF of residuals
par(mfrow=c(1,2))
acf(resid,ylim=c(-1,1),lag.max=60,col=c(2,rep(1,s-1)),lwd=1)
pacf(resid,ylim=c(-1,1),lag.max=60,col=c(rep(1,s-1),2),lwd=1)
par(mfrow=c(1,1))
#Ljung-Box p-values
par(mar=c(2,2,1,1))
tsdiag(model,gof.lag=7*s)
model = mod.1
s=frequency(get(model$series))
resid=model$residuals
#Stationary and Invertible
cat("\nModul of AR Characteristic polynomial Roots: ",
Mod(polyroot(c(1,-model$model$phi))),"\n")
cat("\nModul of MA Characteristic polynomial Roots: ",
Mod(polyroot(c(1,model$model$theta))),"\n")
#Model expressed as an MA infinity (psi-weights)
psis=ARMAtoMA(ar=model$model$phi,ma=model$model$theta,lag.max=36)
names(psis)=paste("psi",1:36)
cat("\nPsi-weights (MA(inf))\n")
cat("\n--------------------\n")
print(psis[1:20])
#Model expressed as an AR infinity (pi-weights)
pis=-ARMAtoMA(ar=-model$model$theta,ma=-model$model$phi,lag.max=36)
names(pis)=paste("pi",1:36)
cat("\nPi-weights (AR(inf))\n")
cat("\n--------------------\n")
print(pis[1:20])
model = mod.2
s=frequency(get(model$series))
resid=model$residuals
#Stationary and Invertible
cat("\nModul of AR Characteristic polynomial Roots: ",
Mod(polyroot(c(1,-model$model$phi))),"\n")
cat("\nModul of MA Characteristic polynomial Roots: ",
Mod(polyroot(c(1,model$model$theta))),"\n")
#Model expressed as an MA infinity (psi-weights)
psis=ARMAtoMA(ar=model$model$phi,ma=model$model$theta,lag.max=36)
names(psis)=paste("psi",1:36)
cat("\nPsi-weights (MA(inf))\n")
cat("\n--------------------\n")
print(psis[1:20])
#Model expressed as an AR infinity (pi-weights)
pis=-ARMAtoMA(ar=-model$model$theta,ma=-model$model$phi,lag.max=36)
names(pis)=paste("pi",1:36)
cat("\nPi-weights (AR(inf))\n")
cat("\n--------------------\n")
print(pis[1:20])
model = mod.1
s=frequency(get(model$series))
resid=model$residuals
#Stationary and Invertible
cat("\nModul of AR Characteristic polynomial Roots: ",
Mod(polyroot(c(1,-model$model$phi))),"\n")
cat("\nModul of MA Characteristic polynomial Roots: ",
Mod(polyroot(c(1,model$model$theta))),"\n")
#Model expressed as an MA infinity (psi-weights)
psis=ARMAtoMA(ar=model$model$phi,ma=model$model$theta,lag.max=36)
names(psis)=paste("psi",1:36)
cat("\nPsi-weights (MA(inf))\n")
cat("\n--------------------\n")
print(psis[1:20])
#Model expressed as an AR infinity (pi-weights)
pis=-ARMAtoMA(ar=-model$model$theta,ma=-model$model$phi,lag.max=36)
names(pis)=paste("pi",1:36)
cat("\nPi-weights (AR(inf))\n")
cat("\n--------------------\n")
print(pis[1:20])
model = mod.1
dades = d1d12logserie
s=frequency(get(model$series))
resid=model$residuals
#Sample ACF vs. Teoric ACF
par(mfrow=c(2,2),mar=c(3,3,3,3))
acf(dades, ylim=c(-1,1) ,lag.max=36,main="Sample ACF")
plot(ARMAacf(model$model$phi,model$model$theta,lag.max=36),ylim=c(-1,1),
type="h",xlab="Lag",  ylab="", main="ACF Teoric")
abline(h=0)
#Sample PACF vs. Teoric PACF
pacf(dades, ylim=c(-1,1) ,lag.max=36,main="Sample PACF")
plot(ARMAacf(model$model$phi,model$model$theta,lag.max=36, pacf=T),ylim=c(-1,1),
type="h", xlab="Lag", ylab="", main="PACF Teoric")
abline(h=0)
par(mfrow=c(1,1))
model = mod.2
dades = d1d12logserie
s=frequency(get(model$series))
resid=model$residuals
#Sample ACF vs. Teoric ACF
par(mfrow=c(2,2),mar=c(3,3,3,3))
acf(dades, ylim=c(-1,1) ,lag.max=36,main="Sample ACF")
plot(ARMAacf(model$model$phi,model$model$theta,lag.max=36),ylim=c(-1,1),
type="h",xlab="Lag",  ylab="", main="ACF Teoric")
abline(h=0)
#Sample PACF vs. Teoric PACF
pacf(dades, ylim=c(-1,1) ,lag.max=36,main="Sample PACF")
plot(ARMAacf(model$model$phi,model$model$theta,lag.max=36, pacf=T),ylim=c(-1,1),
type="h", xlab="Lag", ylab="", main="PACF Teoric")
abline(h=0)
par(mfrow=c(1,1))
model = mod.1
dades = d1d12logserie
s=frequency(get(model$series))
resid=model$residuals
#Sample ACF vs. Teoric ACF
par(mfrow=c(2,2),mar=c(3,3,3,3))
acf(dades, ylim=c(-1,1) ,lag.max=36,main="Sample ACF")
plot(ARMAacf(model$model$phi,model$model$theta,lag.max=36),ylim=c(-1,1),
type="h",xlab="Lag",  ylab="", main="ACF Teoric")
abline(h=0)
#Sample PACF vs. Teoric PACF
pacf(dades, ylim=c(-1,1) ,lag.max=36,main="Sample PACF")
plot(ARMAacf(model$model$phi,model$model$theta,lag.max=36, pacf=T),ylim=c(-1,1),
type="h", xlab="Lag", ylab="", main="PACF Teoric")
abline(h=0)
par(mfrow=c(1,1))
model = mod.2
dades = d1d12logserie
s=frequency(get(model$series))
resid=model$residuals
#Sample ACF vs. Teoric ACF
par(mfrow=c(2,2),mar=c(3,3,3,3))
acf(dades, ylim=c(-1,1) ,lag.max=36,main="Sample ACF")
plot(ARMAacf(model$model$phi,model$model$theta,lag.max=36),ylim=c(-1,1),
type="h",xlab="Lag",  ylab="", main="ACF Teoric")
abline(h=0)
#Sample PACF vs. Teoric PACF
pacf(dades, ylim=c(-1,1) ,lag.max=36,main="Sample PACF")
plot(ARMAacf(model$model$phi,model$model$theta,lag.max=36, pacf=T),ylim=c(-1,1),
type="h", xlab="Lag", ylab="", main="PACF Teoric")
abline(h=0)
par(mfrow=c(1,1))
model = mod.1
dades = d1d12logserie
s=frequency(get(model$series))
resid=model$residuals
#Sample ACF vs. Teoric ACF
par(mfrow=c(2,3),mar=c(3,3,3,3))
acf(dades, ylim=c(-1,1) ,lag.max=36,main="Sample ACF")
plot(ARMAacf(model$model$phi,model$model$theta,lag.max=36),ylim=c(-1,1),
type="h",xlab="Lag",  ylab="", main="ACF Teoric mod.1")
abline(h=0)
#Sample PACF vs. Teoric PACF
pacf(dades, ylim=c(-1,1) ,lag.max=36,main="Sample PACF")
plot(ARMAacf(model$model$phi,model$model$theta,lag.max=36, pacf=T),ylim=c(-1,1),
type="h", xlab="Lag", ylab="", main="PACF Teoric mod.1")
abline(h=0)
model = mod.2
plot(ARMAacf(model$model$phi,model$model$theta,lag.max=36),ylim=c(-1,1),
type="h",xlab="Lag",  ylab="", main="ACF Teoric mod.1")
abline(h=0)
plot(ARMAacf(model$model$phi,model$model$theta,lag.max=36, pacf=T),ylim=c(-1,1),
type="h", xlab="Lag", ylab="", main="PACF Teoric mod.1")
abline(h=0)
par(mfrow=c(1,1))
model = mod.1
dades = d1d12logserie
s=frequency(get(model$series))
resid=model$residuals
#Sample ACF vs. Teoric ACF
par(mfrow=c(2,3),mar=c(3,3,3,3))
acf(dades, ylim=c(-1,1) ,lag.max=36,main="Sample ACF")
plot(ARMAacf(model$model$phi,model$model$theta,lag.max=36),ylim=c(-1,1),
type="h",xlab="Lag",  ylab="", main="ACF Teoric mod.1")
abline(h=0)
model = mod.2
plot(ARMAacf(model$model$phi,model$model$theta,lag.max=36),ylim=c(-1,1),
type="h",xlab="Lag",  ylab="", main="ACF Teoric mod.1")
abline(h=0)
model = mod.1
#Sample PACF vs. Teoric PACF
pacf(dades, ylim=c(-1,1) ,lag.max=36,main="Sample PACF")
plot(ARMAacf(model$model$phi,model$model$theta,lag.max=36, pacf=T),ylim=c(-1,1),
type="h", xlab="Lag", ylab="", main="PACF Teoric mod.1")
abline(h=0)
model = mod.2
plot(ARMAacf(model$model$phi,model$model$theta,lag.max=36, pacf=T),ylim=c(-1,1),
type="h", xlab="Lag", ylab="", main="PACF Teoric mod.1")
abline(h=0)
par(mfrow=c(1,1))
########### Estabilitat Model (SENSE CONSTANT!!!!) ###############
ultim=c(2017,12)
aserie1=window(aserie,end=ultim+c(1,0))
alnserie1=log(serie1)
########### Estabilitat Model (SENSE CONSTANT!!!!) ###############
ultim=c(2017,12)
aserie1=window(aserie,end=ultim+c(1,0))
alnserie1=log(aserie1)
aserie2=window(aserie,end=ultim)
alnserie2=log(aserie2)
(mod=arima(alnserie1,order=c(0,1,1),seasonal=list(order=c(2,1,0),period=12)))
(mod2=arima(alnserie2,order=c(0,1,1),seasonal=list(order=c(2,1,0),period=12)))
########### Estabilitat Model (SENSE CONSTANT!!!!) ###############
ultim=c(2017,12)
aserie1=window(aserie,end=ultim+c(1,0))
plot(aserie1)
alnserie1=log(aserie1)
aserie2=window(aserie,end=ultim)
plot(aserie2)
alnserie2=log(aserie2)
(mod=arima(alnserie1,order=c(0,1,1),seasonal=list(order=c(2,1,0),period=12)))
(mod2=arima(alnserie2,order=c(0,1,1),seasonal=list(order=c(2,1,0),period=12)))
########### Estabilitat Model (SENSE CONSTANT!!!!) ###############
ultim=c(2017,12)
serie1=window(serie,end=ultim+c(1,0))
lnserie1=log(serie1)
serie2=window(serie,end=ultim)
lnserie2=log(serie2)
(mod1 <- arima(lnserie1, order=pdq.1, seasonal=list(order=PDQ.1, period=12)))
(mod2 <- arima(lnserie2, order=pdq.1, seasonal=list(order=PDQ.1, period=12)))
########### Estabilitat Model (SENSE CONSTANT!!!!) ###############
ultim=c(2017,12)
serie1=window(serie,end=ultim+c(1,0))
lnserie1=log(serie1)
serie2=window(serie,end=ultim)
lnserie2=log(serie2)
(mod11 <- arima(lnserie1, order=pdq.1, seasonal=list(order=PDQ.1, period=12)))
(mod12 <- arima(lnserie2, order=pdq.1, seasonal=list(order=PDQ.1, period=12)))
(mod21 <- arima(lnserie1, order=pdq.2, seasonal=list(order=PDQ.2, period=12)))
(mod22 <- arima(lnserie2, order=pdq.2, seasonal=list(order=PDQ.2, period=12)))
